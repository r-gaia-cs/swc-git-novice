<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <title>Software Carpentry: Introdução ao Controle de Versão com Git</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" href="css/bootstrap/bootstrap.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/bootstrap/bootstrap-responsive.css" />
    <link rel="stylesheet" type="text/css" href="css/swc.css" />
    <link rel="alternate" type="application/rss+xml" title="Software Carpentry Blog" href="http://software-carpentry.org/feed.xml"/>
    <meta charset="UTF-8" />
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="banner">
        <a href="http://software-carpentry.org" title="Software Carpentry">
          <img alt="Software Carpentry banner" src="img/software-carpentry-banner.png" />
        </a>
      </div>
      <div class="row-fluid">
        <div class="span10 offset1">
          <h1 class="title">Introdução ao Controle de Versão com Git</h1>
          <h2 class="subtitle">Conflitos</h2>
<div id="objetivos" class="objectives">
<h2>Objetivos</h2>
<ul>
<li>Explicar o que são conflitos e quando eles ocorrem.</li>
<li>Resolver conflitos ocorridos durante um merge.</li>
</ul>
</div>
<p>Logo que pessoas começam a trabalhar em paralelo alguém irá pisar no pé de outra pessoa. Isso também pode acontecer com uma única pessoa: se trabalharmos no mesmo arquivo do nosso notebook e do computador no laboratório, pode ser que façamos mudanças diferentes em cada uma das cópias. Controle de versão ajuda a gerenciarmos esses <a href="reference.html#conflitos">conflitos</a> ao fornecer uma ferramenta para <a href="reference.html#resolver">resolver</a> a sobreposição de mudanças.</p>
<p>Para que possamos aprender como resolver conflitos precisamos, primeiro, criar um. Atualmente o arquivo <code>marte.txt</code> corresponde, em todas as nossas cópias do repositório <code>planeta</code>, a</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cat</span> marte.txt</code></pre>
<pre class="output"><code>Frio e seco, mas tudo é da minha cor favorita.
Duas luas pode ser um problema para o Lobisomem.
Mas a Múmia irá apreciar a falta de humidade.</code></pre>
<p>Vamos adicionar uma linha na cópia no nosso diretório de usuário:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">nano</span> marte.txt
$ <span class="kw">cat</span> marte.txt</code></pre>
<pre class="output"><code>Frio e seco, mas tudo é da minha cor favorita.
Duas luas pode ser um problema para o Lobisomem.
Mas a Múmia irá apreciar a falta de humidade.
Linha adicionada na cópia do Lobisomem.</code></pre>
<p>e enviar essa mudança para o GitHub:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> add marte.txt
$ <span class="kw">git</span> commit -m <span class="st">&quot;Adicionado linha em nossa cópia local&quot;</span></code></pre>
<pre class="output"><code>[master 5ae9631] Adicionado linha em nossa cópia local
 1 file changed, 1 insertion(+)</code></pre>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> push origin master</code></pre>
<pre class="output"><code>Counting objects: 5, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 352 bytes, done.
Total 3 (delta 1), reused 0 (delta 0)
To https://github.com/vlad/planetas
   29aba7c..dabb4c8  master -&gt; master</code></pre>
<p>Agora vamos esperar nosso colaborador fazer uma alteração em sua cópia local <em>sem</em> atualizar a cópia local com as últimas alterações disponíveis no GitHub:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">nano</span> marte.txt
$ <span class="kw">cat</span> marte.txt</code></pre>
<pre class="output"><code>Frio e seco, mas tudo é da minha cor favorita.
Duas luas pode ser um problema para o Lobisomem.
Mas a Múmia irá apreciar a falta de humidade.
Adicionado linha diferente na outra cópia.</code></pre>
<p>Podemos salvar a alteração localmente:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> add marte.txt
$ <span class="kw">git</span> commit -m <span class="st">&quot;Adicionado linha em minha cópia&quot;</span></code></pre>
<pre class="output"><code>[master 07ebc69] Adicionado linha em minha cópia
 1 file changed, 1 insertion(+)</code></pre>
<p>mas o Git não irá deixar enviarmos nossas alterações para o GitHub:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> push origin master</code></pre>
<pre class="output"><code>To https://github.com/vlad/planetas.git
 ! [rejected]        master -&gt; master (non-fast-forward)
error: failed to push some refs to &#39;https://github.com/vlad/planetas.git&#39;
hint: Updates were rejected because the tip of your current branch is behind
hint: its remote counterpart. Merge the remote changes (e.g. &#39;git pull&#39;)
hint: before pushing again.
hint: See the &#39;Note about fast-forwards&#39; in &#39;git push --help&#39; for details.</code></pre>
<p><img src="fig/conflict.svg" alt="The conflicting changes" /></p>
<p>Git detecta que as alterações em uma cópia local sobrepõe aquelas feitas em outra cópia e previne de nós bagunçarmos nosso trabalho anterior. O que precisamos fazer é pegar as mudanças no GitHub, fazer um <a href="reference.html#merge">merge</a> delas na cópia que estamos trabalhando atualmente e depois enviá-las novamente. Vamos começar por baixar as mudanças:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> pull origin master</code></pre>
<pre class="output"><code>remote: Counting objects: 5, done.
remote: Compressing objects: 100% (2/2), done.
remote: Total 3 (delta 1), reused 3 (delta 1)
Unpacking objects: 100% (3/3), done.
From https://github.com/vlad/planetas
 * branch            master     -&gt; FETCH_HEAD
Auto-merging marte.txt
CONFLICT (content): Merge conflict in marte.txt
Automatic merge failed; fix conflicts and then commit the result.</code></pre>
<p><code>git pull</code> informa que existe um conflito e marca os conflitos nas linhas afetadas:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cat</span> marte.txt</code></pre>
<pre class="output"><code>Frio e seco, mas tudo é da minha cor favorita.
Duas luas pode ser um problema para o Lobisomem.
Mas a Múmia irá apreciar a falta de humidade.
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
Linha adicionada na cópia do Lobisomem.
=======
Adicionado linha diferente na outra cópia.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; dabb4c8c450e8475aee9b14b4383acc99f42af1d</code></pre>
<p>Nossas mudanças---aquelas em <code>HEAD</code>---é precedido por <code>&lt;&lt;&lt;&lt;&lt;&lt;&lt;</code>. Depois das nossas mudanças conflitantes, Git adiciona <code>=======</code> como um separador das mudanças e maca o fim das alterações conflitantes baixadas do GitHub com <code>&gt;&gt;&gt;&gt;&gt;&gt;&gt;</code>. (O conjunto de letras e dígitos depois desse marcador identifica a versão que acabamos de baixar.)</p>
<p>Agora depende de nós editar o arquivo para remover os marcadores e reconciliar as alterações. Podemos fazer o que desejarmos: manter as alterações feitas nessa cópia, manter as alterações feitas na outra cópia, escrever algo novo para substituir ambas alterações ou removê-las. Vamos substituir ambas de modo que o arquivo fique como:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cat</span> marte.txt</code></pre>
<pre class="output"><code>Frio e seco, mas tudo é da minha cor favorita.
Duas luas pode ser um problema para o Lobisomem.
Mas a Múmia irá apreciar a falta de humidade.
Removemos o conflito nessa linha.</code></pre>
<p>Para finalizar o merge, nos adicionamos o arquivo <code>marte.txt</code> e criamos uma nova revisão:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> add marte.txt
$ <span class="kw">git</span> status</code></pre>
<pre class="output"><code># On branch master
# All conflicts fixed but you are still merging.
#   (use &quot;git commit&quot; to conclude merge)
#
# Changes to be committed:
#
#   modified:   marte.txt
#</code></pre>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> commit -m <span class="st">&quot;Juntando alterações provenientes do GitHub&quot;</span></code></pre>
<pre class="output"><code>[master 2abf2b1] Juntando alterações provenientes do GitHub</code></pre>
<p>Agora podemos enviar nossas alterações para o GitHub:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> push origin master</code></pre>
<pre class="output"><code>Counting objects: 10, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (6/6), done.
Writing objects: 100% (6/6), 697 bytes, done.
Total 6 (delta 2), reused 0 (delta 0)
To https://github.com/vlad/planetas.git
   dabb4c8..2abf2b1  master -&gt; master</code></pre>
<p>Git mantem o registro de quando realizamos um merge e desse modo não precisamos corrigir novamente esse conflito quando um colaborador baixar as novas mudanças:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">git</span> pull origin master</code></pre>
<pre class="output"><code>remote: Counting objects: 10, done.
remote: Compressing objects: 100% (4/4), done.
remote: Total 6 (delta 2), reused 6 (delta 2)
Unpacking objects: 100% (6/6), done.
From https://github.com/vlad/planetas
 * branch            master     -&gt; FETCH_HEAD
Updating dabb4c8..2abf2b1
Fast-forward
 marte.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)</code></pre>
<p>Como podemos verificar o arquivo <code>marte.txt</code> encontra na forma que salvamos após o merge:</p>
<pre class="sourceCode bash"><code class="sourceCode bash">$ <span class="kw">cat</span> marte.txt</code></pre>
<pre class="output"><code>Frio e seco, mas tudo é da minha cor favorita.
Duas luas pode ser um problema para o Lobisomem.
Mas a Múmia irá apreciar a falta de humidade.
Removemos o conflito nessa linha.</code></pre>
<p>Não precisamos juntar as alterações novamente porque o Git sabe que alguém já fez isso.</p>
<p>A habilidade de sistemas de controle de versão em resolver conflitos é uma das razões pela qual vários usuários tendem a dividir seus programas e artigos em vários arquivos ao invés de armazená-los em um único grande arquivo. Existe um outro benefício: quando conflitos em um arquivo ocorrem com frequência isso é uma indicação de que as responsabilidades não estão claras ou o trabalho precisa ser melhor dividido.</p>
<div id="resolvendo-conflitos-que-você-criou" class="challenge">
<h2>Resolvendo conflitos que você criou</h2>
<ol style="list-style-type: decimal">
<li>Clone o repositório criado pelo seu instrutor.</li>
<li>Adicione um novo arquivo nele e altere um arquivo existente (seu instrutor irá informar qual arquivo).</li>
<li>Quando requisitado pelo seu instrutor, baixe as mudanças do repositório para criar um conflito e resolva-o.</li>
</ol>
</div>
<div id="conflitos-em-arquivos-que-não-são-texto-plano" class="challenge">
<h2>Conflitos em arquivos que não são texto plano</h2>
<p>O que o Git faz quando existe um conflito em uma imagem ou em um arquivo não texto que está armazenado no controle de versão?</p>
</div>
        </div>
      </div>
      <div class="footer">
        <a class="label swc-blue-bg" href="http://software-carpentry.org">Software Carpentry</a>
        <a class="label swc-blue-bg" href="https://github.com/swcarpentry/git-novice">Source</a>
        <a class="label swc-blue-bg" href="mailto:admin@software-carpentry.org">Contact</a>
        <a class="label swc-blue-bg" href="LICENSE.html">License</a>
      </div>
    </div>
    <!-- Javascript placed at the end of the document so the pages load faster -->
    <script src="http://software-carpentry.org/v5/js/jquery-1.9.1.min.js"></script>
    <script src="http://software-carpentry.org/v5/js/bootstrap/bootstrap.min.js"></script>
  </body>
</html>
